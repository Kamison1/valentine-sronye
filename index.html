<script>
  const noBtn = document.getElementById('noBtn');
  const yesBtn = document.getElementById('yesBtn');
  const overlay = document.getElementById('overlay');

  let yesScale = 1;
  let shakeActivated = false;

  // Preload sound
  const yesSound = new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_7b4b4b1f6d.mp3?filename=pop-94319.mp3");
  yesSound.load();

  // Unlock audio on first interaction
  function unlockSound() {
    yesSound.play().then(() => {
      yesSound.pause();
      yesSound.currentTime = 0;
    }).catch(() => {});
    document.removeEventListener('mousemove', unlockSound);
    document.removeEventListener('touchstart', unlockSound);
  }

  document.addEventListener('mousemove', unlockSound);
  document.addEventListener('touchstart', unlockSound);

  function moveNoButton() {
    const container = document.querySelector('.buttons');
    const rect = container.getBoundingClientRect();

    const padding = 40;
    const maxX = rect.width - padding;
    const maxY = rect.height - padding;

    const randomX = Math.random() * maxX;
    const randomY = Math.random() * maxY;

    noBtn.style.left = randomX + 'px';
    noBtn.style.top = randomY + 'px';

    yesScale += 0.4;
    yesBtn.style.setProperty('--scale', yesScale);
    yesBtn.style.transform = `translate(-50%, -50%) scale(${yesScale})`;

    if (!shakeActivated) {
      yesBtn.style.animation = "softShake 0.8s infinite";
      shakeActivated = true;
    }
  }

  noBtn.addEventListener('mouseenter', moveNoButton);
  noBtn.addEventListener('click', moveNoButton);

  function createHeart() {
    const heart = document.createElement('div');
    heart.classList.add('heart');
    heart.textContent = '❤️';
    heart.style.left = Math.random() * 100 + 'vw';
    heart.style.fontSize = (20 + Math.random() * 20) + 'px';
    document.body.appendChild(heart);

    setTimeout(() => heart.remove(), 3000);
  }

  yesBtn.addEventListener('click', () => {
    yesSound.play();

    for (let i = 0; i < 40; i++) {
      setTimeout(createHeart, i * 80);
    }

    setTimeout(() => {
      overlay.style.opacity = 1;
    }, 1500);
  });
</script>
